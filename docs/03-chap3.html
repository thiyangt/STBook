<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3&nbsp; Introduction to Time Series Forecasting – Spatio-Temporal Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-chap4.html" rel="next">
<link href="./02-chap2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-47708def744f7d6bf9e6ade08d3fbeef.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dcaec5c8d80e8fa62fc25e24c15f567a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="https://fonts.googleapis.com/css?family=Fira+Sans|Merriweather|Source%20Code%20Pro" rel="stylesheet">
<script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-chap3.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Time Series Forecasting</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Spatio-Temporal Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Front matter</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-chap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-chap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-chap3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Time Series Forecasting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-chap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Models For Stationary Time Series</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./refs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliography</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title"><b>Sections</b></h2>
   
  <ul class="collapse">
<li><a href="#notation" id="toc-notation" class="nav-link active" data-scroll-target="#notation"><span class="header-section-number">3.1</span> Notation</a></li>
  <li><a href="#simple-time-series-forecasting-techniques" id="toc-simple-time-series-forecasting-techniques" class="nav-link" data-scroll-target="#simple-time-series-forecasting-techniques"><span class="header-section-number">3.2</span> Simple time series forecasting techniques</a></li>
  <li><a href="#example-electricity-demand-forecasting" id="toc-example-electricity-demand-forecasting" class="nav-link" data-scroll-target="#example-electricity-demand-forecasting"><span class="header-section-number">3.3</span> Example: Electricity Demand Forecasting</a></li>
  <li><a href="#time-series-and-stochastic-processes" id="toc-time-series-and-stochastic-processes" class="nav-link" data-scroll-target="#time-series-and-stochastic-processes"><span class="header-section-number">3.4</span> Time Series and Stochastic Processes</a></li>
  <li><a href="#statistical-properties" id="toc-statistical-properties" class="nav-link" data-scroll-target="#statistical-properties"><span class="header-section-number">3.5</span> Statistical Properties</a></li>
  <li><a href="#weekly-stationary" id="toc-weekly-stationary" class="nav-link" data-scroll-target="#weekly-stationary"><span class="header-section-number">3.6</span> Weekly stationary</a></li>
  <li><a href="#strict-stationarity-of-a-time-series" id="toc-strict-stationarity-of-a-time-series" class="nav-link" data-scroll-target="#strict-stationarity-of-a-time-series"><span class="header-section-number">3.7</span> Strict stationarity of a time series</a></li>
  <li><a href="#independent-and-identically-distributed-iid-noise" id="toc-independent-and-identically-distributed-iid-noise" class="nav-link" data-scroll-target="#independent-and-identically-distributed-iid-noise"><span class="header-section-number">3.8</span> 1. independent and identically distributed (iid) noise</a></li>
  <li><a href="#white-noise" id="toc-white-noise" class="nav-link" data-scroll-target="#white-noise"><span class="header-section-number">3.9</span> 2. White noise</a></li>
  <li><a href="#every-iid0-sigma2-sequence-is-wn0-sigma2-but-not-conversely.-why" id="toc-every-iid0-sigma2-sequence-is-wn0-sigma2-but-not-conversely.-why" class="nav-link" data-scroll-target="#every-iid0-sigma2-sequence-is-wn0-sigma2-but-not-conversely.-why"><span class="header-section-number">3.10</span> Every <span class="math inline">(IID(0, \sigma^2)</span> sequence is <span class="math inline">(WN(0, \sigma^2)</span> but not conversely. Why?</a></li>
  <li><a href="#example-of-wn-but-not-iid" id="toc-example-of-wn-but-not-iid" class="nav-link" data-scroll-target="#example-of-wn-but-not-iid"><span class="header-section-number">3.11</span> 5. Example of WN but not IID</a></li>
  <li><a href="#simulation-example" id="toc-simulation-example" class="nav-link" data-scroll-target="#simulation-example"><span class="header-section-number">3.12</span> Simulation example</a></li>
  <li><a href="#random-walk" id="toc-random-walk" class="nav-link" data-scroll-target="#random-walk"><span class="header-section-number">3.13</span> 3. Random walk</a></li>
  <li><a href="#identifying-non-stationarity-in-the-mean" id="toc-identifying-non-stationarity-in-the-mean" class="nav-link" data-scroll-target="#identifying-non-stationarity-in-the-mean"><span class="header-section-number">3.14</span> Identifying non-stationarity in the mean</a></li>
  <li><a href="#backshift-notation" id="toc-backshift-notation" class="nav-link" data-scroll-target="#backshift-notation"><span class="header-section-number">3.15</span> Backshift notation:</a></li>
  <li><a href="#ordinary-differencing" id="toc-ordinary-differencing" class="nav-link" data-scroll-target="#ordinary-differencing"><span class="header-section-number">3.16</span> Ordinary differencing</a></li>
  <li><a href="#seasonal-differencing" id="toc-seasonal-differencing" class="nav-link" data-scroll-target="#seasonal-differencing"><span class="header-section-number">3.17</span> Seasonal differencing</a></li>
  <li><a href="#twice-differenced-series" id="toc-twice-differenced-series" class="nav-link" data-scroll-target="#twice-differenced-series"><span class="header-section-number">3.18</span> Twice-differenced series</a></li>
  <li><a href="#deterministic-trend-vs-stochastic-trend" id="toc-deterministic-trend-vs-stochastic-trend" class="nav-link" data-scroll-target="#deterministic-trend-vs-stochastic-trend"><span class="header-section-number">3.19</span> Deterministic trend vs Stochastic trend</a></li>
  <li><a href="#random-walk-1" id="toc-random-walk-1" class="nav-link" data-scroll-target="#random-walk-1"><span class="header-section-number">3.20</span> Random walk</a></li>
  <li><a href="#random-walk-with-drift" id="toc-random-walk-with-drift" class="nav-link" data-scroll-target="#random-walk-with-drift"><span class="header-section-number">3.21</span> Random walk with drift</a></li>
  <li><a href="#common-trend-removal-de-trending-procedures" id="toc-common-trend-removal-de-trending-procedures" class="nav-link" data-scroll-target="#common-trend-removal-de-trending-procedures"><span class="header-section-number">3.22</span> Common trend removal (de-trending) procedures</a></li>
  <li><a href="#remove-seasonality" id="toc-remove-seasonality" class="nav-link" data-scroll-target="#remove-seasonality"><span class="header-section-number">3.23</span> Remove seasonality</a></li>
  <li><a href="#example-differencing-on-airpassengers-data" id="toc-example-differencing-on-airpassengers-data" class="nav-link" data-scroll-target="#example-differencing-on-airpassengers-data"><span class="header-section-number">3.24</span> Example: Differencing on AirPassengers Data</a></li>
  <li><a href="#notation-id" id="toc-notation-id" class="nav-link" data-scroll-target="#notation-id"><span class="header-section-number">3.25</span> Notation: I(d)</a></li>
  <li><a href="#variance-stabilization" id="toc-variance-stabilization" class="nav-link" data-scroll-target="#variance-stabilization"><span class="header-section-number">3.26</span> Variance stabilization</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Time Series Forecasting</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="notation" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="notation">
<span class="header-section-number">3.1</span> Notation</h2>
<p><span class="math inline">\hat{Y}_{T+h|T}</span> - The forecast of the time series <span class="math inline">𝑌</span> at time <span class="math inline">T+h</span>, made using the information available up to time <span class="math inline">T</span>.</p>
</section><section id="simple-time-series-forecasting-techniques" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="simple-time-series-forecasting-techniques">
<span class="header-section-number">3.2</span> Simple time series forecasting techniques</h2>
<ol type="1">
<li><p>Average method</p></li>
<li><p>Naive method/ random walk method</p></li>
<li><p>Seasonal naive method</p></li>
<li><p>Drift method</p></li>
</ol>
<p><a href="https://otexts.com/fpp2/simple-methods.html">Reading</a></p>
</section><section id="example-electricity-demand-forecasting" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="example-electricity-demand-forecasting">
<span class="header-section-number">3.3</span> Example: Electricity Demand Forecasting</h2>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://fable.tidyverts.org">fable</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/fpp2-package/">fpp2</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">aelec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/window.html">window</a></span><span class="op">(</span><span class="va">elec</span>, start<span class="op">=</span><span class="fl">1980</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">aelec</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot some forecasts</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">aelec</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autolayer.html">autolayer</a></span><span class="op">(</span><span class="fu">meanf</span><span class="op">(</span><span class="va">aelec</span>, h<span class="op">=</span><span class="fl">11</span><span class="op">)</span>,</span>
<span>    series<span class="op">=</span><span class="st">"Mean"</span>, PI<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autolayer.html">autolayer</a></span><span class="op">(</span><span class="fu">naive</span><span class="op">(</span><span class="va">aelec</span>, h<span class="op">=</span><span class="fl">11</span><span class="op">)</span>,</span>
<span>    series<span class="op">=</span><span class="st">"Naïve"</span>, PI<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autolayer.html">autolayer</a></span><span class="op">(</span><span class="fu">snaive</span><span class="op">(</span><span class="va">aelec</span>, h<span class="op">=</span><span class="fl">11</span><span class="op">)</span>,</span>
<span>    series<span class="op">=</span><span class="st">"Seasonal naïve"</span>, PI<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Forecasts from Mean, NAIVE and SNAIVE"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>colour<span class="op">=</span><span class="fu">guide_legend</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Forecast"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section><section id="time-series-and-stochastic-processes" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="time-series-and-stochastic-processes">
<span class="header-section-number">3.4</span> Time Series and Stochastic Processes</h2>
<p>The terms stochastic processes and time series are closely related but not the same.</p>
<p>A is a collection of random variables indexed by time (or space).</p>
<p><span class="math display">\{X_t : t \in T\},</span></p>
<p>where <span class="math inline">T</span> is the index set (e.g., discrete or continuous time).</p>
<p>A is a single realization (observed data) of a stochastic process. It is the actual sequence of observations collected over time.</p>
<p>In short:</p>
<p>Stochastic process = model/theory (all possible sequences). The probability mechanism (all possible paths).</p>
<p>Time series = observed data (one sequence). One observed path (the single trajectory we actually have).</p>
</section><section id="statistical-properties" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="statistical-properties">
<span class="header-section-number">3.5</span> Statistical Properties</h2>
<section id="mean-function" class="level3"><h3 class="anchored" data-anchor-id="mean-function">Mean function</h3>
<p>Let <span class="math inline">{X_1, X_2, ...}</span> be a sequence of time index random variables.</p>
<p>The <strong>mean function</strong> of <span class="math inline">{X_t}</span> is</p>
<p><span class="math display">\mu_X(t)=E(X_t).</span></p>
</section><section id="covariance-function" class="level3"><h3 class="anchored" data-anchor-id="covariance-function">Covariance function</h3>
<p>The <strong>covariance function</strong> of <span class="math inline">{X_t}</span> is</p>
<p><span class="math display">\gamma_X(r, s)=Cov(X_r, X_s)=E[(X_r-\mu_X(r))(X_s-\mu_X(s))]</span></p>
<p>for all integers <span class="math inline">(r)</span> and <span class="math inline">(s)</span>.</p>
</section><section id="autocovariance-function" class="level3"><h3 class="anchored" data-anchor-id="autocovariance-function">Autocovariance function</h3>
<p>The autocovariance function of <span class="math inline">{X_t}</span> at lag <span class="math inline">(h)</span> is defined by <span class="math display">\gamma_X(h):=\gamma_X(h, 0)=\gamma(t+h, t)=Cov(X_{t+h}, X_t).</span></p>
<p>or</p>
<p>The autocovariance function of <span class="math inline">{X_t}</span> at lag <span class="math inline">(h)</span> is</p>
<p><span class="math display">\gamma_X(h)=Cov(X_{t+h}, X_t).</span></p>
</section><section id="autocorrelation-function" class="level3"><h3 class="anchored" data-anchor-id="autocorrelation-function">Autocorrelation function</h3>
<p>The autocorrelation function of <span class="math inline">{X_t}</span> at lag <span class="math inline">(h)</span> is</p>
<p><span class="math display">\rho_X(h)=\frac{\gamma_X(h)}{\gamma_X(0)}=Cor(X_{t+h}, X_t).</span></p>
</section></section><section id="weekly-stationary" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="weekly-stationary">
<span class="header-section-number">3.6</span> Weekly stationary</h2>
<p>A time series <span class="math inline">{X_t}</span> is called weekly stationary if</p>
<ul>
<li><p><span class="math inline">\mu_X(t)</span> is independent of <span class="math inline">t</span>.</p></li>
<li><p><span class="math inline">Var(X_t) = \sigma^2</span>, Variance is constant. 2</p></li>
<li><p><span class="math inline">\gamma_X(t+h, t)</span> is independent of <span class="math inline">(t)</span> for each <span class="math inline">(h)</span>. The autocovariance depends only on the lag (<span class="math inline">\gamma(h)</span> depends only on how far apart two points are (<span class="math inline">h</span>), and not on the actual time <span class="math inline">t</span>.</p></li>
</ul>
<p>In other words the statistical properties of the time series (mean, variance, autocorrelation, etc.) do not depend on the time at which the series is observed, that is no trend or seasonality. However, a time series with cyclic behaviour (but with no trend or seasonality) is stationary.</p>
</section><section id="strict-stationarity-of-a-time-series" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="strict-stationarity-of-a-time-series">
<span class="header-section-number">3.7</span> Strict stationarity of a time series</h2>
<p>A time series <span class="math inline">\{X_t\}</span> is called strictly stationary if the random vector <span class="math inline">[X_1, X_2..., X_n]</span> and <span class="math inline">[X_{1+h}, X_{2+h}..., X_{n+h}]</span> have the same joint distribution for all integers <span class="math inline">(h)</span> and <span class="math inline">(n &gt; 0)</span>.</p>
</section><section id="independent-and-identically-distributed-iid-noise" class="level2" data-number="3.8"><h2 data-number="3.8" class="anchored" data-anchor-id="independent-and-identically-distributed-iid-noise">
<span class="header-section-number">3.8</span> 1. independent and identically distributed (iid) noise</h2>
<ol type="1">
<li><p>no trend or seasonal component</p></li>
<li><p>observations are independent and identically distributed (iid) random variables with zero mean.</p></li>
<li><p>Notation: <span class="math inline">{X_t} \sim IID(0, \sigma^2)</span></p></li>
<li><p>plays an important role as a building block for more complicated time series.</p></li>
</ol></section><section id="white-noise" class="level2" data-number="3.9"><h2 data-number="3.9" class="anchored" data-anchor-id="white-noise">
<span class="header-section-number">3.9</span> 2. White noise</h2>
<p>If <span class="math inline">{X_t}</span> is a sequence of uncorrelated random variables, each with zero mean and variance <span class="math inline">\sigma^2</span>, then such a sequence is referred to as <strong>white noise</strong>.</p>
</section><section id="every-iid0-sigma2-sequence-is-wn0-sigma2-but-not-conversely.-why" class="level2" data-number="3.10"><h2 data-number="3.10" class="anchored" data-anchor-id="every-iid0-sigma2-sequence-is-wn0-sigma2-but-not-conversely.-why">
<span class="header-section-number">3.10</span> Every <span class="math inline">(IID(0, \sigma^2)</span> sequence is <span class="math inline">(WN(0, \sigma^2)</span> but not conversely. Why?</h2>
<section id="white-noise-wn" class="level3"><h3 class="anchored" data-anchor-id="white-noise-wn">1. White Noise (WN)</h3>
<p>A sequence <span class="math inline">\{X_t\}</span> is called <strong>white noise</strong> with mean <span class="math inline">0</span> and variance <span class="math inline">\sigma^2</span>, written <span class="math inline">WN(0, \sigma^2)</span>, if:</p>
<ul>
<li>
<span class="math inline">\mathbb{E}[X_t] = 0</span> for all <span class="math inline">t</span>.<br>
</li>
<li>
<span class="math inline">\mathrm{Var}(X_t) = \sigma^2</span> for all <span class="math inline">t</span>.<br>
</li>
<li>
<span class="math inline">\mathrm{Cov}(X_t, X_s) = 0</span> for all <span class="math inline">t \neq s</span> (uncorrelated across time).</li>
</ul>
<p>Notice: <em>uncorrelated <span class="math inline">\neq</span> independent</em>.</p>
</section><section id="i.i.d.-0-sigma2" class="level3"><h3 class="anchored" data-anchor-id="i.i.d.-0-sigma2">2. i.i.d. <span class="math inline">(0, \sigma^2)</span>
</h3>
<p>A sequence <span class="math inline">\{X_t\}</span> is <span class="math inline">IID(0, \sigma^2)</span> if:</p>
<ul>
<li>
<span class="math inline">\mathbb{E}[X_t] = 0</span>.<br>
</li>
<li>
<span class="math inline">\mathrm{Var}(X_t) = \sigma^2</span>.<br>
</li>
<li>
<span class="math inline">X_t</span> are independent and identically distributed.</li>
</ul></section><section id="why-every-iid0-sigma2-is-wn0-sigma2" class="level3"><h3 class="anchored" data-anchor-id="why-every-iid0-sigma2-is-wn0-sigma2">3. Why every <span class="math inline">IID(0, \sigma^2)</span> is <span class="math inline">WN(0, \sigma^2)</span>
</h3>
<ul>
<li>Independence <span class="math inline">\;\Rightarrow\;</span> zero correlation.<br>
</li>
<li>So, an i.i.d. sequence automatically satisfies the white noise conditions (same mean, same variance, no correlation).</li>
</ul>
<p>Therefore:</p>
<p><span class="math display">
IID(0, \sigma^2) \;\;\Rightarrow\;\; WN(0, \sigma^2).
</span></p>
</section><section id="why-not-conversely" class="level3"><h3 class="anchored" data-anchor-id="why-not-conversely">4. Why not conversely?</h3>
<p>The reverse is not always true, because <strong>white noise only requires uncorrelatedness, not full independence</strong>.</p>
<p>That means a sequence could be white noise but still have dependence in higher moments (nonlinear dependence).</p>
</section></section><section id="example-of-wn-but-not-iid" class="level2" data-number="3.11"><h2 data-number="3.11" class="anchored" data-anchor-id="example-of-wn-but-not-iid">
<span class="header-section-number">3.11</span> 5. Example of WN but not IID</h2>
<p>Let <span class="math inline">\{Z_t\}</span> be i.i.d. <span class="math inline">N(0,1)</span>. Define</p>
<p><span class="math display">
X_t = Z_t \cdot Z_{t-1}.
</span></p>
<p>Then:</p>
<ul>
<li>
<span class="math inline">\mathbb{E}[X_t] = 0</span>,<br>
</li>
<li>
<span class="math inline">\mathrm{Var}(X_t) = 1</span>,<br>
</li>
<li>For <span class="math inline">t \neq s</span>, <span class="math inline">\mathrm{Cov}(X_t, X_s) = 0</span>. ✅ So it’s white noise.</li>
</ul>
<p>But the sequence is <strong>not independent</strong> (because <span class="math inline">X_t</span> depends on <span class="math inline">Z_{t-1}</span>, which also appears in <span class="math inline">X_{t-1}</span>).</p>
<p>Thus,</p>
<p><span class="math display">
X_t \sim WN(0,1) \quad \text{but not} \quad IID(0,1).
</span></p>
</section><section id="simulation-example" class="level2" data-number="3.12"><h2 data-number="3.12" class="anchored" data-anchor-id="simulation-example">
<span class="header-section-number">3.12</span> Simulation example</h2>
<p>IID series</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span>        <span class="co"># length of series</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">1</span>      <span class="co"># standard deviation</span></span>
<span></span>
<span><span class="co"># IID(0, sigma^2) ~ Normal(0, sigma^2)</span></span>
<span><span class="va">iid_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Quick check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">iid_seq</span><span class="op">)</span>      <span class="co"># should be ~0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.008570445</code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">iid_seq</span><span class="op">)</span>       <span class="co"># should be ~sigma^2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8895506</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">iid_seq</span><span class="op">)</span>       <span class="co"># autocorrelations ~ 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>White noise</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Construct WN but not IID</span></span>
<span><span class="va">wn_not_iid</span> <span class="op">&lt;-</span> <span class="va">Z</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Z</span><span class="op">[</span><span class="op">-</span><span class="va">n</span><span class="op">]</span>   <span class="co"># X_t = Z_t * Z_{t-1}, length n-1</span></span>
<span></span>
<span><span class="co"># Quick check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">wn_not_iid</span><span class="op">)</span>        <span class="co"># ~0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.05650406</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">wn_not_iid</span><span class="op">)</span>         <span class="co"># ~1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8196189</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">wn_not_iid</span><span class="op">)</span>         <span class="co"># uncorrelated -&gt; ACF ~ 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Side-by-side visualisation</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section><section id="random-walk" class="level2" data-number="3.13"><h2 data-number="3.13" class="anchored" data-anchor-id="random-walk">
<span class="header-section-number">3.13</span> 3. Random walk</h2>
<p>A random walk process is obtained by cumulatively summing iid random variables. If <span class="math inline">{S_t, t=0, 1, 2, ...}</span> is a random walk process, then <span class="math inline">S_0 =0</span></p>
<p><span class="math inline">S_1=0+X_1</span></p>
<p><span class="math inline">S_2=0+X_1+X_2</span></p>
<p><span class="math inline">...</span></p>
<p><span class="math inline">S_t=X_1+X_2+...+X_t.</span></p>
<p><strong>Question</strong></p>
<p>Is <span class="math inline">{S_t, t=0, 1, 2, ...}</span> a weak stationary process?</p>
</section><section id="identifying-non-stationarity-in-the-mean" class="level2" data-number="3.14"><h2 data-number="3.14" class="anchored" data-anchor-id="identifying-non-stationarity-in-the-mean">
<span class="header-section-number">3.14</span> Identifying non-stationarity in the mean</h2>
<ul>
<li><p>Using time series plot</p></li>
<li>
<p>ACF plot</p>
<ul>
<li><p>ACF of stationary time series will drop to relatively quickly.</p></li>
<li><p>The ACF of non-stationary series decreases slowly.</p></li>
<li><p>For non-stationary series, the ACF at lag 1 is often large and positive.</p></li>
</ul>
</li>
</ul></section><section id="backshift-notation" class="level2" data-number="3.15"><h2 data-number="3.15" class="anchored" data-anchor-id="backshift-notation">
<span class="header-section-number">3.15</span> Backshift notation:</h2>
<p><span class="math display">BX_t=X_{t-1}</span></p>
</section><section id="ordinary-differencing" class="level2" data-number="3.16"><h2 data-number="3.16" class="anchored" data-anchor-id="ordinary-differencing">
<span class="header-section-number">3.16</span> Ordinary differencing</h2>
<p>The first-order differencing can be defined as</p>
<p><span class="math display">\nabla X_t = X_t-X_{t-1}=X_t-BX_t=(1-B)X_t</span> where <span class="math inline">\nabla=1-B</span>.</p>
<p>The second-order differencing</p>
<p><span class="math display">\nabla^2X_t=\nabla(\nabla X_t)=\nabla(X_t-X_{t-1})=\nabla X_t - \nabla X_{t-1}</span></p>
<p><span class="math display">\nabla X_t - \nabla X_{t-1}=(X_t-X_{t-1})-(X_{t-1}-X_{t-2})</span></p>
<p>In practice, we seldom need to go beyond second order differencing.</p>
</section><section id="seasonal-differencing" class="level2" data-number="3.17"><h2 data-number="3.17" class="anchored" data-anchor-id="seasonal-differencing">
<span class="header-section-number">3.17</span> Seasonal differencing</h2>
<p>Differencing between an observation and the corresponding observation from the previous year.</p>
<p><span class="math display">\nabla_mX_t=X_t-X_{t-m}=(1-B^m)X_t</span> where <span class="math inline">(m)</span> is the number of seasons. For monthly, <span class="math inline">(m=12)</span>, for quarterly <span class="math inline">(m=4)</span>.</p>
<p>For monthly series</p>
<p><span class="math display">\nabla_{12}X_t=X_t-X_{t-12}</span></p>
</section><section id="twice-differenced-series" class="level2" data-number="3.18"><h2 data-number="3.18" class="anchored" data-anchor-id="twice-differenced-series">
<span class="header-section-number">3.18</span> Twice-differenced series</h2>
<p><span class="math display">\nabla^2_{12}X_t=\nabla_{12}X_t-\nabla_{12}X_{t-1}</span> <span class="math display">\nabla_{12}X_t-\nabla_{12}X_{t-1}=(X_t-X_{t-12})-(X_{t-1}-X_{t-13})</span> If seasonality is strong, the seasonal differencing should be done first.</p>
</section><section id="deterministic-trend-vs-stochastic-trend" class="level2" data-number="3.19"><h2 data-number="3.19" class="anchored" data-anchor-id="deterministic-trend-vs-stochastic-trend">
<span class="header-section-number">3.19</span> Deterministic trend vs Stochastic trend</h2>
<section id="deterministic-trend" class="level3"><h3 class="anchored" data-anchor-id="deterministic-trend">Deterministic trend</h3>
<p><span class="math display">Y_t  = f(t) + \epsilon_t</span></p>
<p>where <span class="math inline">\epsilon_t \sim iid(0, \sigma^2)</span>, <span class="math inline">t = 1, 2, ...T</span></p>
<p>Mean of the process is time dependent, but the variance of the process is constant.</p>
<p>A trend is deterministic if it is a nonrandom function of time. A deterministic trend is a predictable, fixed function of time. If you know the form of the function, you can determine the trend exactly.</p>
</section><section id="stochastic-trend" class="level3"><h3 class="anchored" data-anchor-id="stochastic-trend">Stochastic trend</h3>
<p>A stochastic trend is driven by random shocks that accumulate over time. A stochastic trend is driven by random shocks (also called innovations, disturbances, or error terms) that accumulate over time.</p>
<p><strong>1. Random walk</strong></p>
<p><span class="math display">Y_t = Y_{t-1} + \epsilon_t</span></p>
<ul>
<li><p>Random walk has a stochastic trend.</p></li>
<li><p>Model behind naive method.</p></li>
</ul>
<p>A trend is said to be stochastic if it is a random function of time.</p>
<p><strong>2. Random walk with drift</strong></p>
<p><span class="math display">Y_t = \alpha +  Y_{t-1} + \epsilon_t</span></p>
<ul>
<li><p>Random walk with drift has a stochastic trend and a deterministic trend.</p></li>
<li><p>Model behind drift method.</p></li>
</ul></section></section><section id="random-walk-1" class="level2" data-number="3.20"><h2 data-number="3.20" class="anchored" data-anchor-id="random-walk-1">
<span class="header-section-number">3.20</span> Random walk</h2>
<p><span class="math display">
\begin{aligned}
  Y_t &amp;= Y_{t-1} + \epsilon_t \\
     Y_1    &amp;= Y_0 + \epsilon_1 \\
         Y_2 &amp;=  Y_1 + \epsilon_2=Y_0 + \epsilon_1 + \epsilon_2\\
          Y_3 &amp;=  Y_2 + \epsilon_3=Y_0 + \epsilon_1 + \epsilon_2 +\epsilon_3\\
          .   \\
          Y_t &amp;=Y_{t-1} + \epsilon_t=Y_0 + \epsilon_1 + \epsilon_2 + \epsilon_3 +...+ \epsilon_t = Y_0 + \sum_{i=1}^{t} \epsilon_t
\end{aligned}
</span></p>
<p>Mean: <span class="math inline">E(Y_t) = Y_0</span>.</p>
<p>Variance: <span class="math inline">Var(Y_t)=t \sigma^2</span>.</p>
</section><section id="random-walk-with-drift" class="level2" data-number="3.21"><h2 data-number="3.21" class="anchored" data-anchor-id="random-walk-with-drift">
<span class="header-section-number">3.21</span> Random walk with drift</h2>
<p><span class="math display">
\begin{aligned}
  Y_t &amp;= \alpha + Y_{t-1} + \epsilon_t \\
     Y_1    &amp;= \alpha+Y_0 + \epsilon_1 \\
         Y_2 &amp;= \alpha+ Y_1 + \epsilon_2=2 \alpha+Y_0 + \epsilon_1 + \epsilon_2\\
          Y_3 &amp;= \alpha+ Y_2 + \epsilon_3= 3 \alpha+ Y_0 + \epsilon_1 + \epsilon_2 +\epsilon_3\\
          .   \\
          Y_t &amp;= \alpha+Y_{t-1} + \epsilon_t= t \alpha+ Y_0 + \epsilon_1 + \epsilon_2 + \epsilon_3 +...+ \epsilon_t \\
          Y_t &amp;= t \alpha + Y_0 + \sum_{i=1}^{t} \epsilon_t
\end{aligned}
</span></p>
<p>It has a <em>deterministic trend</em> <span class="math inline">(Y_0 + t \alpha)</span> and a <em>stochastic trend</em> <span class="math inline">\sum_{i=1}^{t} \epsilon_t</span>.</p>
<p>Mean: <span class="math inline">E(Y_t) = Y_0 + t\alpha</span></p>
<p>Variance: <span class="math inline">Var(Y_t) = t\sigma^2</span>.</p>
<p>There is a trend in both mean and variance.</p>
</section><section id="common-trend-removal-de-trending-procedures" class="level2" data-number="3.22"><h2 data-number="3.22" class="anchored" data-anchor-id="common-trend-removal-de-trending-procedures">
<span class="header-section-number">3.22</span> Common trend removal (de-trending) procedures</h2>
<ol type="1">
<li>
<p>Deterministic trend: Time-trend regression</p>
<p>The trend can be removed by fitting a deterministic polynomial time trend. The residual series after removing the trend will give us the de-trended series.</p>
</li>
<li>
<p>Stochastic trend: Differencing</p>
<p>The process is also known as a <strong>Difference-stationary process</strong>.</p>
</li>
</ol></section><section id="remove-seasonality" class="level2" data-number="3.23"><h2 data-number="3.23" class="anchored" data-anchor-id="remove-seasonality">
<span class="header-section-number">3.23</span> Remove seasonality</h2>
<p>Take seasonal differencing</p>
</section><section id="example-differencing-on-airpassengers-data" class="level2" data-number="3.24"><h2 data-number="3.24" class="anchored" data-anchor-id="example-differencing-on-airpassengers-data">
<span class="header-section-number">3.24</span> Example: Differencing on AirPassengers Data</h2>
<p>The built-in AirPassengers dataset (monthly airline passengers, 1949–1960) has trend + seasonality.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"AirPassengers"</span><span class="op">)</span></span>
<span><span class="va">ts_data</span> <span class="op">&lt;-</span> <span class="va">AirPassengers</span></span>
<span></span>
<span><span class="co">#par(mfrow = c(3,2))</span></span>
<span></span>
<span><span class="co"># 1. Original series</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ts_data</span>, main <span class="op">=</span> <span class="st">"Original Series"</span>, ylab <span class="op">=</span> <span class="st">"Passengers"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">ts_data</span>, main <span class="op">=</span> <span class="st">"ACF: Original Series"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. First difference (remove trend)</span></span>
<span><span class="va">diff1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">ts_data</span>, differences <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">diff1</span>, main <span class="op">=</span> <span class="st">"1st Difference (Remove Trend)"</span>, ylab <span class="op">=</span> <span class="st">"Difference"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">diff1</span>, main <span class="op">=</span> <span class="st">"ACF: 1st Difference"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Seasonal difference (lag = 12, remove seasonality)</span></span>
<span><span class="va">diff_seasonal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">diff1</span>, lag <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">diff_seasonal</span>, main <span class="op">=</span> <span class="st">"Seasonal Difference (Remove Seasonality)"</span>, ylab <span class="op">=</span> <span class="st">"Difference"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-8-5.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">diff_seasonal</span>, main <span class="op">=</span> <span class="st">"ACF: Seasonal Difference"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-8-6.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Seasonal difference (lag = 12, remove seasonality from the original series)</span></span>
<span><span class="va">diff_seasonal_only</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">ts_data</span>, lag <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">diff_seasonal_only</span>, main <span class="op">=</span> <span class="st">"Seasonal Difference (Remove Seasonality)"</span>, ylab <span class="op">=</span> <span class="st">"Difference"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-8-7.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">diff_seasonal_only</span>, main <span class="op">=</span> <span class="st">"ACF: Seasonal Difference"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-8-8.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ts_data</span>, <span class="fl">14</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1949 112 118 132 129 121 135 148 148 136 119 104 118
1950 115 126                                        </code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">diff1</span>, <span class="fl">14</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1949       6  14  -3  -8  14  13   0 -12 -17 -15  14
1950  -3  11  15                                    </code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">diff_seasonal</span>, <span class="fl">14</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1950       5   1  -3  -2  10   8   0   0  -8  -4  12
1951   8  -6  13                                    </code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">diff_seasonal_only</span>, <span class="fl">14</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1950   3   8   9   6   4  14  22  22  22  14  10  22
1951  30  24                                        </code></pre>
</div>
</div>
</section><section id="notation-id" class="level2" data-number="3.25"><h2 data-number="3.25" class="anchored" data-anchor-id="notation-id">
<span class="header-section-number">3.25</span> Notation: I(d)</h2>
<p>Integrated to order <span class="math inline">d</span>: Series can be made stationary by differencing <span class="math inline">d</span> times.</p>
<ul>
<li>Known as <span class="math inline">I(d)</span> process.</li>
</ul>
<p><strong>Question:</strong> Show that random walk process is an <span class="math inline">I(1)</span> process.</p>
<p>The random walk process is called a unit root process. (If one of the roots turns out to be one, then the process is called unit root process.)</p>
</section><section id="variance-stabilization" class="level2" data-number="3.26"><h2 data-number="3.26" class="anchored" data-anchor-id="variance-stabilization">
<span class="header-section-number">3.26</span> Variance stabilization</h2>
<p>Transform the series.</p>
<p>Eg:</p>
<ul>
<li><p>Square root: <span class="math inline">W_t = \sqrt{Y_t}</span></p></li>
<li>
<p>Logarithm: <span class="math inline">W_t = log({Y_t})</span></p>
<ul>
<li><p>This very useful.</p></li>
<li><p>Interpretable: Changes in a log value are <strong>relative (percent) changes on the original sclae</strong>.</p></li>
</ul>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">log_ts</span>, main <span class="op">=</span> <span class="st">"Log-Transformed Series"</span>, ylab <span class="op">=</span> <span class="st">"log(Passengers)"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03-chap3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02-chap2.html" class="pagination-link" aria-label="Introduction to Time Series Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-chap4.html" class="pagination-link" aria-label="Models For Stationary Time Series">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Models For Stationary Time Series</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>